
local this = {}
local ffi = require("ffi")
function this.ternary(cond,then_,else_) if cond then return then_ else return else_ end end
function this.eps()             return 1e-18; end
function this.pi()              return 3.1415926535897932384; end
function this.random()          return math.random(); end
function this.irandom()         return math.floor(math.random() * 4294967296); end
function this.clip(x,low,high)  return (this.ternary(x<low,low,this.ternary(x>high,high,x))); end
function this.real(x)           return x; end
function this.int(x)            local int_part,_ = math.modf(x) return int_part; end
function this.sin(x)            return math.sin(x); end
function this.cos(x)            return math.cos(x); end
function this.abs(x)            return math.abs(x); end
function this.exp(x)            return math.exp(x); end
function this.floor(x)          return math.floor(x); end
function this.tan(x)            return math.tan(x); end
function this.tanh(x)           return math.tanh(x); end
function this.sqrt(x)           return x; end
function this.set(a,i,v)        a[i+1]=v; end
function this.get(a,i)          return a[i+1]; end
function this.makeArray(size,v) local a = {}; for i=1,size do a[i]=v end return a; end
function this.wrap_array(a)     return a; end
local Saturate_soft_table_c0 = {(-4.1979),(-4.0802),(-3.9628),(-3.8458),(-3.7293),(-3.6134),(-3.4980),(-3.3832),(-3.2692),(-3.1558),(-3.0433),(-2.9317),(-2.8210),(-2.7112),(-2.6025),(-2.4949),(-2.3884),(-2.2832),(-2.1792),(-2.0766),(-1.9754),(-1.8756),(-1.7773),(-1.6806),(-1.5855),(-1.4921),(-1.4005),(-1.3106),(-1.2226),(-1.1365),(-1.0523),(-0.9702),(-0.8901),(-0.8120),(-0.7361),(-0.6624),(-0.5909),(-0.5217),(-0.4547),(-0.3901),(-0.3278),(-0.2678),(-0.2103),(-0.1552),(-0.1025),(-0.0523),(-0.0045),0.0408,0.0836,0.1240,0.1619,0.1974,0.2305,0.2611,0.2894,0.3152,0.3388,0.3600,0.3790,0.3958,0.4104,0.4228,0.4332,0.4416,0.4481,0.4526,0.4554,0.4564,0.4557,0.4535,0.4498,0.4446,0.4381,0.4304,0.4215,0.4115,0.4006,0.3888,0.3762,0.3629,0.3490,0.3346,0.3198,0.3047,0.2893,0.2737,0.2581,0.2425,0.2270,0.2117,0.1966,0.1818,0.1673,0.1533,0.1398,0.1267,0.1143,0.1024,0.0912,0.0806,0.0707,0.0616,0.0531,0.0453,0.0382,0.0319,0.0262,0.0212,0.0168,0.0131,0.0099,0.0073,0.0051,0.0034,0.0022,0.0013,0.0006,0.0003,0.0001,0.0000,0.0000,(-0.0000),(-0.0001),(-0.0003),(-0.0006),(-0.0013),(-0.0022),(-0.0034),(-0.0051),(-0.0073),(-0.0099),(-0.0131),(-0.0168),(-0.0212),(-0.0262),(-0.0319),(-0.0382),(-0.0453),(-0.0531),(-0.0616),(-0.0707),(-0.0806),(-0.0912),(-0.1024),(-0.1143),(-0.1267),(-0.1398),(-0.1533),(-0.1673),(-0.1818),(-0.1966),(-0.2117),(-0.2270),(-0.2425),(-0.2581),(-0.2737),(-0.2893),(-0.3047),(-0.3198),(-0.3346),(-0.3490),(-0.3629),(-0.3762),(-0.3888),(-0.4006),(-0.4115),(-0.4215),(-0.4304),(-0.4381),(-0.4446),(-0.4498),(-0.4535),(-0.4557),(-0.4564),(-0.4554),(-0.4526),(-0.4481),(-0.4416),(-0.4332),(-0.4228),(-0.4104),(-0.3958),(-0.3790),(-0.3600),(-0.3388),(-0.3152),(-0.2894),(-0.2611),(-0.2305),(-0.1974),(-0.1619),(-0.1240),(-0.0836),(-0.0408),0.0045,0.0523,0.1025,0.1552,0.2103,0.2678,0.3278,0.3901,0.4547,0.5217,0.5909,0.6624,0.7361,0.8120,0.8901,0.9702,1.0523,1.1365,1.2226,1.3106,1.4005,1.4921,1.5855,1.6806,1.7773,1.8756,1.9754,2.0766,2.1792,2.2832,2.3884,2.4949,2.6025,2.7112,2.8210,2.9317,3.0433,3.1558,3.2692,3.3832,3.4980,3.6134,3.7293,3.8458,3.9628,4.0802,4.1979,4.3160};
local Saturate_soft_table_c1 = {0.6763,0.6862,0.6962,0.7062,0.7162,0.7263,0.7364,0.7466,0.7568,0.7670,0.7772,0.7874,0.7977,0.8079,0.8182,0.8284,0.8386,0.8489,0.8590,0.8692,0.8793,0.8894,0.8994,0.9094,0.9192,0.9291,0.9388,0.9485,0.9580,0.9675,0.9768,0.9860,0.9951,1.0041,1.0129,1.0215,1.0300,1.0384,1.0465,1.0545,1.0622,1.0698,1.0772,1.0843,1.0912,1.0979,1.1043,1.1105,1.1165,1.1221,1.1275,1.1327,1.1375,1.1421,1.1463,1.1503,1.1540,1.1573,1.1604,1.1631,1.1655,1.1676,1.1694,1.1709,1.1720,1.1729,1.1734,1.1736,1.1734,1.1730,1.1723,1.1712,1.1699,1.1682,1.1663,1.1641,1.1616,1.1589,1.1559,1.1527,1.1493,1.1456,1.1418,1.1377,1.1335,1.1291,1.1245,1.1199,1.1151,1.1102,1.1052,1.1002,1.0951,1.0899,1.0848,1.0797,1.0746,1.0695,1.0645,1.0596,1.0547,1.0500,1.0454,1.0409,1.0366,1.0325,1.0286,1.0248,1.0213,1.0180,1.0150,1.0122,1.0097,1.0075,1.0055,1.0038,1.0025,1.0014,1.0006,1.0001,1.0000,1.0001,1.0006,1.0014,1.0025,1.0038,1.0055,1.0075,1.0097,1.0122,1.0150,1.0180,1.0213,1.0248,1.0286,1.0325,1.0366,1.0409,1.0454,1.0500,1.0547,1.0596,1.0645,1.0695,1.0746,1.0797,1.0848,1.0899,1.0951,1.1002,1.1052,1.1102,1.1151,1.1199,1.1245,1.1291,1.1335,1.1377,1.1418,1.1456,1.1493,1.1527,1.1559,1.1589,1.1616,1.1641,1.1663,1.1682,1.1699,1.1712,1.1723,1.1730,1.1734,1.1736,1.1734,1.1729,1.1720,1.1709,1.1694,1.1676,1.1655,1.1631,1.1604,1.1573,1.1540,1.1503,1.1463,1.1421,1.1375,1.1327,1.1275,1.1221,1.1165,1.1105,1.1043,1.0979,1.0912,1.0843,1.0772,1.0698,1.0622,1.0545,1.0465,1.0384,1.0300,1.0215,1.0129,1.0041,0.9951,0.9860,0.9768,0.9675,0.9580,0.9485,0.9388,0.9291,0.9192,0.9094,0.8994,0.8894,0.8793,0.8692,0.8590,0.8489,0.8386,0.8284,0.8182,0.8079,0.7977,0.7874,0.7772,0.7670,0.7568,0.7466,0.7364,0.7263,0.7162,0.7062,0.6962,0.6862,0.6763,0.6665};
local Saturate_soft_table_c2 = {0.0103,0.0105,0.0107,0.0110,0.0112,0.0114,0.0116,0.0118,0.0121,0.0123,0.0125,0.0128,0.0130,0.0132,0.0135,0.0137,0.0140,0.0142,0.0145,0.0147,0.0150,0.0152,0.0155,0.0157,0.0160,0.0163,0.0165,0.0168,0.0170,0.0173,0.0175,0.0178,0.0181,0.0183,0.0186,0.0188,0.0191,0.0193,0.0196,0.0198,0.0201,0.0203,0.0205,0.0208,0.0210,0.0212,0.0214,0.0217,0.0219,0.0221,0.0223,0.0224,0.0226,0.0228,0.0229,0.0231,0.0232,0.0234,0.0235,0.0236,0.0237,0.0238,0.0239,0.0239,0.0240,0.0240,0.0240,0.0241,0.0240,0.0240,0.0240,0.0239,0.0239,0.0238,0.0237,0.0236,0.0234,0.0233,0.0231,0.0229,0.0227,0.0224,0.0222,0.0219,0.0216,0.0213,0.0210,0.0206,0.0203,0.0199,0.0195,0.0190,0.0186,0.0181,0.0176,0.0171,0.0166,0.0161,0.0155,0.0149,0.0143,0.0137,0.0131,0.0125,0.0118,0.0111,0.0105,0.0098,0.0091,0.0083,0.0076,0.0069,0.0061,0.0054,0.0046,0.0039,0.0031,0.0023,0.0016,0.0008,0.0000,(-0.0008),(-0.0016),(-0.0023),(-0.0031),(-0.0039),(-0.0046),(-0.0054),(-0.0061),(-0.0069),(-0.0076),(-0.0083),(-0.0091),(-0.0098),(-0.0105),(-0.0111),(-0.0118),(-0.0125),(-0.0131),(-0.0137),(-0.0143),(-0.0149),(-0.0155),(-0.0161),(-0.0166),(-0.0171),(-0.0176),(-0.0181),(-0.0186),(-0.0190),(-0.0195),(-0.0199),(-0.0203),(-0.0206),(-0.0210),(-0.0213),(-0.0216),(-0.0219),(-0.0222),(-0.0224),(-0.0227),(-0.0229),(-0.0231),(-0.0233),(-0.0234),(-0.0236),(-0.0237),(-0.0238),(-0.0239),(-0.0239),(-0.0240),(-0.0240),(-0.0240),(-0.0241),(-0.0240),(-0.0240),(-0.0240),(-0.0239),(-0.0239),(-0.0238),(-0.0237),(-0.0236),(-0.0235),(-0.0234),(-0.0232),(-0.0231),(-0.0229),(-0.0228),(-0.0226),(-0.0224),(-0.0223),(-0.0221),(-0.0219),(-0.0217),(-0.0214),(-0.0212),(-0.0210),(-0.0208),(-0.0205),(-0.0203),(-0.0201),(-0.0198),(-0.0196),(-0.0193),(-0.0191),(-0.0188),(-0.0186),(-0.0183),(-0.0181),(-0.0178),(-0.0175),(-0.0173),(-0.0170),(-0.0168),(-0.0165),(-0.0163),(-0.0160),(-0.0157),(-0.0155),(-0.0152),(-0.0150),(-0.0147),(-0.0145),(-0.0142),(-0.0140),(-0.0137),(-0.0135),(-0.0132),(-0.0130),(-0.0128),(-0.0125),(-0.0123),(-0.0121),(-0.0118),(-0.0116),(-0.0114),(-0.0112),(-0.0110),(-0.0107),(-0.0105),(-0.0103),(-0.0101)};
function this.Saturate_soft_table(x)
   local index = this.clip(this.int((5.0000 * (x + 24.0000))),0,240);
   return (Saturate_soft_table_c0[index+1] + (x * (Saturate_soft_table_c1[index+1] + (Saturate_soft_table_c2[index+1] * x))));

end

function this.Saturate_soft_process(_ctx,x)
   return this.Saturate_soft_table(x);

end

function this.Saturate_soft_noteOn(_ctx,note,velocity,channel)

end

function this.Saturate_soft_noteOff(_ctx,note,channel)

end

function this.Saturate_soft_controlChange(_ctx,control,value,channel)

end

function this.Saturate_soft_default(_ctx)

end


function this.process(x) return this.Saturate_soft_process(x) end
function this.noteOn(note,velocity,channel) return this.Saturate_soft_noteOn(note,velocity,channel) end
function this.noteOff(note,channel) return this.Saturate_soft_noteOff(note,channel) end
function this.controlChange(control,value,channel) return this.Saturate_soft_controlChange(control,value,channel) end
function this.init() return this.Saturate_soft_process_init() end
function this.default(ctx) return this.Saturate_soft_default(ctx) end
this.config = { inputs = 1, outputs = 1, noteon_inputs = 3, noteoff_inputs = 2, controlchange_inputs = 3, is_active = false }
return this


local this = {}
local ffi = require("ffi")
function this.ternary(cond,then_,else_) if cond then return then_ else return else_ end end
function this.eps()             return 1e-18; end
function this.pi()              return 3.1415926535897932384; end
function this.random()          return math.random(); end
function this.irandom()         return math.floor(math.random() * 4294967296); end
function this.clip(x,low,high)  return (this.ternary(x<low,low,this.ternary(x>high,high,x))); end
function this.real(x)           return x; end
function this.int(x)            local int_part,_ = math.modf(x) return int_part; end
function this.sin(x)            return math.sin(x); end
function this.cos(x)            return math.cos(x); end
function this.abs(x)            return math.abs(x); end
function this.exp(x)            return math.exp(x); end
function this.floor(x)          return math.floor(x); end
function this.tan(x)            return math.tan(x); end
function this.tanh(x)           return math.tanh(x); end
function this.sqrt(x)           return x; end
function this.set(a,i,v)        a[i+1]=v; end
function this.get(a,i)          return a[i+1]; end
function this.makeArray(size,v) local a = {}; for i=1,size do a[i]=v end return a; end
function this.wrap_array(a)     return a; end
local Saturate_table_c0 = {(-1.00000),(-1.00000),(-0.99990),(-0.99990),(-1.00000),(-1.00000),(-1.00000),(-1.00000),(-1.00000),(-1.00000),(-0.99990),(-1.00000),(-1.00000),(-1.00000),(-0.99990),(-1.00000),(-1.00000),(-1.00000),(-1.00000),(-1.00000),(-1.00000),(-1.00000),(-1.00000),(-0.99990),(-0.99990),(-0.99990),(-1.00000),(-1.00000),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-1.00000),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99990),(-0.99980),(-0.99980),(-0.99970),(-0.99960),(-0.99940),(-0.99920),(-0.99890),(-0.99840),(-0.99780),(-0.99700),(-0.99580),(-0.99420),(-0.99200),(-0.98900),(-0.98480),(-0.97920),(-0.97160),(-0.96140),(-0.94780),(-0.92960),(-0.90570),(-0.87440),(-0.83390),(-0.78240),(-0.71780),(-0.63870),(-0.54450),(-0.43670),(-0.31980),(-0.20250),(-0.09770),(-0.01970),0.02110,0.02660,0.01320,0.00170,0.00000,(-0.00170),(-0.01320),(-0.02660),(-0.02110),0.01970,0.09770,0.20250,0.31980,0.43670,0.54450,0.63870,0.71780,0.78240,0.83390,0.87440,0.90570,0.92960,0.94780,0.96140,0.97160,0.97920,0.98480,0.98900,0.99200,0.99420,0.99580,0.99700,0.99780,0.99840,0.99890,0.99920,0.99940,0.99960,0.99970,0.99980,0.99980,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,0.99990,1.00000,0.99990,0.99990,1.00000,0.99990,0.99990,0.99990,0.99990,1.00000,1.00000,0.99990,0.99990,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,0.99990,1.00000,1.00000,0.99990,1.00000,1.00000,0.99990,1.00000,1.00000,1.00000,1.00000,1.00000};
local Saturate_table_c1 = {0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00010,0.00010,0.00020,0.00030,0.00040,0.00060,0.00100,0.00140,0.00200,0.00290,0.00420,0.00610,0.00870,0.01240,0.01770,0.02510,0.03550,0.05010,0.07040,0.09850,0.13690,0.18890,0.25810,0.34840,0.46260,0.60100,0.75830,0.92040,1.06260,1.15320,1.16780,1.11210,1.03330,0.99670,1.03330,1.11210,1.16780,1.15320,1.06260,0.92040,0.75830,0.60100,0.46260,0.34840,0.25810,0.18890,0.13690,0.09850,0.07040,0.05010,0.03550,0.02510,0.01770,0.01240,0.00870,0.00610,0.00420,0.00290,0.00200,0.00140,0.00100,0.00060,0.00040,0.00030,0.00020,0.00010,0.00010,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000};
local Saturate_table_c2 = {0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00010,0.00010,0.00020,0.00040,0.00060,0.00090,0.00130,0.00200,0.00300,0.00450,0.00680,0.01000,0.01490,0.02210,0.03250,0.04770,0.06930,0.09950,0.14050,0.19320,0.25590,0.32080,0.37090,0.38040,0.32260,0.18780,0.00000,(-0.18780),(-0.32260),(-0.38040),(-0.37090),(-0.32080),(-0.25590),(-0.19320),(-0.14050),(-0.09950),(-0.06930),(-0.04770),(-0.03250),(-0.02210),(-0.01490),(-0.01000),(-0.00680),(-0.00450),(-0.00300),(-0.00200),(-0.00130),(-0.00090),(-0.00060),(-0.00040),(-0.00020),(-0.00010),(-0.00010),0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000};
function this.Saturate_table(x)
   local index = this.clip(this.int((5.00000 * (x + 24.00000))),0,240);
   return (Saturate_table_c0[index+1] + (x * (Saturate_table_c1[index+1] + (Saturate_table_c2[index+1] * x))));

end

function this.Saturate_process(_ctx,x)
   return this.Saturate_table(x);

end

function this.Saturate_noteOn(_ctx,note,velocity,channel)

end

function this.Saturate_noteOff(_ctx,note,channel)

end

function this.Saturate_controlChange(_ctx,control,value,channel)

end

function this.Saturate_default(_ctx)

end


function this.process(x) return this.Saturate_process(x) end
function this.noteOn(note,velocity,channel) return this.Saturate_noteOn(note,velocity,channel) end
function this.noteOff(note,channel) return this.Saturate_noteOff(note,channel) end
function this.controlChange(control,value,channel) return this.Saturate_controlChange(control,value,channel) end
function this.init() return this.Saturate_process_init() end
function this.default(ctx) return this.Saturate_default(ctx) end
this.config = { inputs = 1, outputs = 1, noteon_inputs = 3, noteoff_inputs = 2, controlchange_inputs = 3, is_active = false }
return this
